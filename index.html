<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Mini Dots</title><meta name="viewport" content="width=device-width,initial-scale=1"><style>body{margin:0;font-family:sans-serif;text-align:center;touch-action:none;user-select:none}#menu,#game{padding:1em}select,button{font-size:1em;padding:0.3em;margin:0.5em}#scoreDisplay{font-size:1.2em;margin:0.5em auto}#grid{--grid-size:8;display:grid;gap:2vw;justify-content:center;margin:1em auto;width:90vw;max-width:90vmin;transition:background 0.2s}.dot{width:calc(90vw/var(--grid-size));aspect-ratio:1/1;border-radius:50%;background:gray}.selected{outline:3px solid #000}.combo-flash{background:#fff !important}</style></head><body><div id="menu"><h1>Mini Dots</h1>Grid Size:<select id="gridSize"><option>6</option><option selected>8</option><option>10</option></select>Colors:<select id="colorCount"><option>3</option><option selected>4</option><option>5</option><option>6</option></select><button onclick="startGame()">Start</button></div><div id="game" style="display:none;"><div id="scoreDisplay">Score: 0</div><button onclick="location.reload()">Restart</button><button onclick="undo()">Undo</button><div id="grid"></div></div><script>const masterColors=["#FF4136","#0074D9","#2ECC40","#FFDC00","#B10DC9","#FF851B"];let grid=[],selected=[],size=8,colors=[],isDragging=!1,score=0,undoStack=[],comboTriggered=!1,gridEl=document.getElementById("grid"),scoreDisplay=document.getElementById("scoreDisplay");function startGame(){size=+gridSize.value;let c=+colorCount.value;colors=masterColors.slice(0,c),menu.style.display="none",game.style.display="block",gridEl.style.setProperty("--grid-size",size),gridEl.style.gridTemplateColumns=`repeat(${size},1fr)`,initGrid()}function initGrid(){grid=[],gridEl.innerHTML="";for(let y=0;y<size;y++){grid[y]=[];for(let x=0;x<size;x++){let col=colors[Math.floor(Math.random()*colors.length)];grid[y][x]=col;let d=document.createElement("div");d.className="dot",d.style.background=col,d.dataset.x=x,d.dataset.y=y,d.addEventListener("mousedown",startDrag),d.addEventListener("touchstart",startDrag,{passive:!1}),d.addEventListener("mouseenter",dragOver),d.addEventListener("touchmove",dragMove,{passive:!1}),gridEl.appendChild(d)}}document.addEventListener("mouseup",endDrag),document.addEventListener("touchend",endDrag)}function startDrag(e){e.preventDefault(),isDragging=!0,comboTriggered=!1;let t=e.target,x=+t.dataset.x,y=+t.dataset.y;selected=[{x,y}],t.classList.add("selected")}function dragOver(e){if(!isDragging||comboTriggered)return;let t=e.target;if(!t.classList.contains("dot"))return;let x=+t.dataset.x,y=+t.dataset.y,idx=selected.findIndex(s=>s.x===x&&s.y===y),last=selected[selected.length-1];if(grid[y][x]!==grid[last.y][last.x]||!isAdjacent({x,y},last))return;if(idx!==-1&&selected.length>=4&&idx<selected.length-2)return saveState(),removeDots(grid[y][x],!0),comboTriggered=!0,isDragging=!1,void flashGrid();selected.push({x,y}),t.classList.add("selected")}function dragMove(e){e.preventDefault();let t=e.touches[0],el=document.elementFromPoint(t.clientX,t.clientY);dragOver({target:el})}function endDrag(){if(!isDragging)return;isDragging=!1;let last=selected[selected.length-1];if(selected.length>=4&&selected.slice(0,-2).some(p=>isAdjacent(p,last)))saveState(),removeDots(grid[selected[0].y][selected[0].x],!0),flashGrid();else if(selected.length>=2)saveState(),removeDots(grid[selected[0].y][selected[0].x]);else clearSelection()}function isAdjacent(a,b){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y)===1}function removeDots(color,all=!1){let toRemove=all?getAll(color):[...selected];selected=[],score+=toRemove.length,scoreDisplay.textContent="Score: "+score,toRemove.forEach(({x,y})=>{grid[y][x]=null;let i=y*size+x;gridEl.children[i].style.background="transparent",gridEl.children[i].classList.remove("selected")}),setTimeout(dropAndRefill,300)}function getAll(c){let o=[];for(let y=0;y<size;y++)for(let x=0;x<size;x++)grid[y][x]===c&&o.push({x,y});return o}function dropAndRefill(){for(let x=0;x<size;x++){let col=[];for(let y=0;y<size;y++)grid[y][x]&&col.push(grid[y][x]);while(col.length<size)col.unshift(colors[Math.floor(Math.random()*colors.length)]);for(let y=0;y<size;y++)grid[y][x]=col[y]}render()}function render(){for(let y=0;y<size;y++)for(let x=0;x<size;x++){let i=y*size+x;gridEl.children[i].style.background=grid[y][x]}}function clearSelection(){selected.forEach(({x,y})=>{let i=y*size+x;gridEl.children[i].classList.remove("selected")}),selected=[]}function flashGrid(){gridEl.classList.add("combo-flash"),setTimeout(()=>gridEl.classList.remove("combo-flash"),150)}function saveState(){undoStack.push({grid:JSON.parse(JSON.stringify(grid)),score}),undoStack.length>20&&undoStack.shift()}function undo(){if(!undoStack.length)return;let last=undoStack.pop();grid=JSON.parse(JSON.stringify(last.grid)),score=last.score,scoreDisplay.textContent="Score: "+score,render()}document.body.addEventListener("touchmove",e=>{e.target.classList.contains("dot")&&e.preventDefault()},{passive:!1});const gridSize=document.getElementById("gridSize"),colorCount=document.getElementById("colorCount"),menu=document.getElementById("menu"),game=document.getElementById("game");</script></body></html>