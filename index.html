<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Mini Dots</title><meta name="viewport" content="width=device-width,initial-scale=1"><style>body{margin:0;font-family:sans-serif;text-align:center;background:#f5f5f5;touch-action:none;user-select:none}#menu,#game{padding:1em}select,button,input{font-size:1em;padding:.3em;margin:.5em}#grid-container{padding:2vw;background:#fff}#grid{--grid-size:8;display:grid;gap:1vw;justify-content:center;margin:0 auto;width:80vw;max-width:80vmin;height:80vw;max-height:80vmin;transition:background .2s}.dot{width:100%;aspect-ratio:1/1;border-radius:50%;background:gray;display:flex;align-items:center;justify-content:center;color:#000;font-weight:bold;border:2px solid #fff}.selected{outline:3px solid #000}.combo-flash{background:#fff !important}#customColors{display:none;width:100%;max-width:300px}</style></head><body><div id="menu"><h1>Mini Dots</h1>Grid Size:<select id="gridSize"><option>6</option><option selected>8</option><option>10</option></select>Colors:<select id="colorCount"><option value="2">2</option><option value="3">3</option><option value="4" selected>4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="custom">Custom</option></select><br><input id="customColors" placeholder="Comma-separated hex colors (up to 26)"><br>Colorblind:<select id="colorblind"><option value="0" selected>Off</option><option value="1">On</option></select><button id="startBtn">Start</button></div><div id="game" style="display:none"><div id="scoreDisplay">Score: 0</div><button onclick="location.reload()">Restart</button><button onclick="undo()">Undo</button><div id="grid-container"><div id="grid"></div></div></div><script>const masterColors=["#FF4136","#0074D9","#2ECC40","#FFDC00","#B10DC9","#FF851B","#7FDBFF","#F012BE","#01FF70"],colorblindMap="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");let grid=[],selected=[],size=8,colors=[],cbMode=!1,score=0,comboTriggered=!1,isDragging=!1,undoStack=[];const gridEl=document.getElementById("grid"),scoreDisplay=document.getElementById("scoreDisplay");function isAdjacent(a,b){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y)===1}function saveState(){undoStack.push({grid:JSON.parse(JSON.stringify(grid)),score}),undoStack.length>20&&undoStack.shift()}function undo(){if(!undoStack.length)return;let e=undoStack.pop();grid=JSON.parse(JSON.stringify(e.grid)),score=e.score,scoreDisplay.textContent="Score: "+score,render()}function startGame(){size=+gridSize.value,cbMode=colorblind.value==="1";let e=colorCount.value;if("custom"===e){colors=document.getElementById("customColors").value.split(",").map(e=>e.trim()).filter(e=>/^#?[0-9a-f]{3,6}$/i.test(e)).slice(0,26);if(colors.length<2)return alert("Please enter at least 2 valid hex colors.");colors=colors.map(e=>e.startsWith("#")?e:"#"+e)}else colors=masterColors.slice(0,+e);menu.style.display="none",game.style.display="block",gridEl.style.setProperty("--grid-size",size),gridEl.style.gridTemplateColumns=`repeat(${size}, 1fr)`,initGrid(),score=0,scoreDisplay.textContent="Score: 0",undoStack=[]}function initGrid(){grid=[],gridEl.innerHTML="";let e=gridEl.clientWidth/size;for(let t=0;t<size;t++){grid[t]=[];for(let n=0;n<size;n++){let i=Math.floor(Math.random()*colors.length);grid[t][n]=colors[i];let o=document.createElement("div");o.className="dot",o.style.background=cbMode?colors[i]:colors[i],o.dataset.x=n,o.dataset.y=t,cbMode&&(o.textContent=colorblindMap[i],o.style.fontSize=Math.floor(e*.6)+"px"),o.addEventListener("mousedown",startDrag),o.addEventListener("touchstart",startDrag,{passive:!1}),o.addEventListener("mouseenter",dragOver),o.addEventListener("touchmove",dragMove,{passive:!1}),gridEl.appendChild(o)}}document.addEventListener("mouseup",endDrag),document.addEventListener("touchend",endDrag)}function startDrag(e){e.preventDefault(),isDragging=!0,comboTriggered=!1;let t=e.target,n=+t.dataset.x,i=+t.dataset.y;selected=[{x:n,y:i}],t.classList.add("selected")}function dragOver(e){if(!isDragging)return;let t=e.target;if(!t.classList.contains("dot"))return;let n=+t.dataset.x,i=+t.dataset.y,o=selected[selected.length-1];if(n===o.x&&i===o.y)return;let r=selected.findIndex(e=>e.x===n&&e.y===i);if(selected.length>1&&r===selected.length-2){let e=selected.pop();if(!(e.x===selected[0].x&&e.y===selected[0].y)){let n=e.y*size+e.x;gridEl.children[n].classList.remove("selected")}return}if(grid[i][n]!==grid[o.y][o.x]||!isAdjacent({x:n,y:i},o))return;if(r!==-1){comboTriggered=!0,selected.push({x:n,y:i});let e=i*size+n;gridEl.children[e].classList.add("selected");return}selected.push({x:n,y:i}),t.classList.add("selected")}function dragMove(e){e.preventDefault();let t=e.touches[0],n=document.elementFromPoint(t.clientX,t.clientY);dragOver({target:n})}function endDrag(){if(!isDragging)return;isDragging=!1;if(selected.length>=2){saveState();let e=grid[selected[0].y][selected[0].x];let t=comboTriggered?getAll(e):[...selected];removeDots(t)}else clearSelection()}function getAll(e){let t=[];for(let n=0;n<size;n++)for(let i=0;i<size;i++)grid[n][i]===e&&t.push({x:i,y:n});return t}function removeDots(e){selected=[],score+=e.length,scoreDisplay.textContent="Score: "+score,e.forEach(({x:t,y:n})=>{grid[n][t]=null;let i=n*size+t;gridEl.children[i].style.background="transparent",gridEl.children[i].textContent="",gridEl.children[i].classList.remove("selected")}),setTimeout(dropAndRefill,300)}function dropAndRefill(){for(let e=0;e<size;e++){let t=[];for(let n=0;n<size;n++)grid[n][e]&&t.push(grid[n][e]);for(;t.length<size;)t.unshift(colors[Math.floor(Math.random()*colors.length)]);for(let n=0;n<size;n++)grid[n][e]=t[n]}render()}function render(){let e=gridEl.clientWidth/size;for(let t=0;t<size;t++)for(let n=0;n<size;n++){let i=t*size+n,o=grid[t][n],r=colors.indexOf(o),s=gridEl.children[i];s.style.background=cbMode?o:o,s.textContent=cbMode?colorblindMap[r]:"",s.style.fontSize=cbMode?Math.floor(e*.6)+"px":""}}function clearSelection(){selected.forEach(({x:e,y:t})=>{let n=t*size+e;gridEl.children[n].classList.remove("selected")}),selected=[]}document.getElementById("startBtn").addEventListener("click",startGame),document.getElementById("colorCount").addEventListener("change",e=>{document.getElementById("customColors").style.display="custom"===e.target.value?"block":"none"}),document.body.addEventListener("touchmove",e=>{e.target.classList.contains("dot")&&e.preventDefault()},{passive:!1});const gridSize=document.getElementById("gridSize"),colorCount=document.getElementById("colorCount"),colorblind=document.getElementById("colorblind"),menu=document.getElementById("menu"),game=document.getElementById("game");</script></body></html>
